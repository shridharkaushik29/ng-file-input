angular.module("ngFileInput",[]).directive("fileInput",["$files",function(a){return{replace:true,require:"ngModel",restrict:"A",link:function(c,d,b,e){d.on("click",function(){var f={};if(b.multiple!==undefined){f.multiple=true}a.choose(f).then(function(g){e.$setViewValue(g)})})}}}]).provider("$files",function(){this.$get=["$q",function(c){var a={};var b=angular.element('<input class="ng-shridhar-files" type="file">').appendTo("body").hide();a.choose=function(e){var g=c.defer();var d=_.merge(e,{});if(d.multiple){b.attr("multiple",true)}else{b.removeAttr("multiple")}if(d.accept){var f;if(_.isArray(d.accept)){f=d.accept.join(",")}else{f=d.accept}b.attr("accept",f)}else{b.removeAttr("accept")}b.off("change");b.one("change",function(){var h;if(d.multiple){h=this.files}else{h=this.files[0]}h=a.mapInfo(h);g.resolve(h);b.remove()});b.click();return g.promise};a.mapInfo=function(d){if(d instanceof FileList){d=Array.from(d)}if(_.isArray(d)){_.forEach(d,function(e){e.url=URL.createObjectURL(e)})}else{if(_.isObject(d)){d.url=URL.createObjectURL(d)}}return d};return a}]});